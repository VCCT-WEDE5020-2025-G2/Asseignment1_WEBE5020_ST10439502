<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Basic Meta -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO -->
  <title>Hope Haven — Community Services & Support</title>
  <meta name="description" content="Hope Haven supports individuals with developmental disabilities through residential and community services, advocacy, and inclusive programs.">

  <!-- Favicon -->
  <link rel="icon" href="/images/favicon-32x32.png">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/volunteer.css">
  <link rel="stylesheet" href="/css/forms.css">
</head>

<body>
  <!-- Header -->
  <header class="main-header">
    <div class="header-logo">
      <a href="index.html">
        <img src="/images/HH-Logo-Final.webp" alt="Hope Haven logo" width="160" height="60">
      </a>
    </div>

    <nav class="navbar" aria-label="Primary Navigation">
      <div class="nav-left">
        <ul>
          <li><a href="index.html" aria-current="page">Home</a></li>
          <li><a href="our_mission.html">Our Mission</a></li>
          <li><a href="about_us.html">About Us</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="Enquiry.html">Volunteer</a></li>
          <li><a href="contact_us.html">Contact Us</a></li>
        </ul>
      </div>

      <div class="nav-right">
        <form action="/search.html" method="get" class="site-search" role="search">
          <label for="q" class="visually-hidden">Search</label>
          <input id="q" type="search" name="q" placeholder="Search…" required>
          <button type="submit">Search</button>
        </form>
      </div>
    </nav>
  </header>

  <!-- CONTENT -->
  <main class="container" id="content">
    <section class="section" aria-labelledby="enquiry-title">
      <h1 id="enquiry-title">Volunteer / Enquiry Form</h1>

      <form id="enquiryForm" class="form-box" novalidate>
        <!-- Honeypot -->
        <input type="text" name="company" autocomplete="off" tabindex="-1" aria-hidden="true"
               style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">

        <div class="form-row">
          <div>
            <label for="enqName">Full Name</label>
            <input type="text" id="enqName" name="name" required minlength="3"
                   placeholder="Enter your full name" autocomplete="name">
          </div>

          <div>
            <label for="enqEmail">Email Address</label>
            <input type="email" id="enqEmail" name="email" required
                   placeholder="you@example.com" autocomplete="email">
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="enqPhone">Phone (optional)</label>
            <input type="tel" id="enqPhone" name="phone"
                   pattern="^[0-9+()\-.\s]{7,}$"
                   placeholder="+1 (555) 123-4567" autocomplete="tel">
            <p class="form-note">Format examples: 012 345 6789 or +1 (555) 123-4567</p>
          </div>

          <div>
            <label for="enqType">Type of Enquiry</label>
            <select id="enqType" name="type" required>
              <option value="">-- Select --</option>
              <option value="volunteer">Volunteering</option>
              <option value="sponsorship">Sponsorship</option>
              <option value="services">Service Information</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>

        <fieldset>
          <legend>Preferred Contact Method</legend>
          <label><input type="radio" name="contact_method" value="email" checked> Email</label>
          <label><input type="radio" name="contact_method" value="phone"> Phone</label>
        </fieldset>

        <div>
          <label for="enqMessage">Your Message</label>
          <textarea id="enqMessage" name="message" rows="6" required minlength="10"
                    placeholder="Tell us how we can help..."></textarea>
        </div>

        <!-- NEW: Choose email service -->
        <fieldset style="border:1px solid #e6e6e6; padding:.75rem 1rem; border-radius:10px;">
          <legend>Send with</legend>
          <label><input type="radio" name="sendMethod" value="mailto" checked> Default mail app (mailto)</label><br>
          <label><input type="radio" name="sendMethod" value="gmail"> Gmail (in browser)</label><br>
          <label><input type="radio" name="sendMethod" value="outlook"> Outlook (Office 365 web)</label>
        </fieldset>

        <label class="checkbox">
          <input type="checkbox" id="enqConsent" name="consent" required>
          I consent to Hope Haven contacting me about this enquiry.
        </label>

        <button type="submit" id="enqSubmit" class="btn-submit">Open Email</button>

        <p id="formStatus" class="form-note" aria-live="polite"></p>
      </form>
    </section>
  </main>

  <!-- FOOTER  -->
  <footer>
    <div class="footer-container">
      <div class="footer-about">
        <h2>Hope Haven of Northeast Georgia</h2>
        <p>Preparing, empowering, and connecting adults with developmental disabilities since 1958.</p>
        <p>© <span id="current-year"></span> Hope Haven of Northeast Georgia, Inc. All rights reserved.</p>
      </div>

      <div class="footer-links">
        <h3>Quick Links</h3>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="our_mission.html">Our Mission</a></li>
          <li><a href="about_us.html">About Us</a></li>
          <li><a href="services.html">Services</a></li>
          <li><a href="Enquiry.html" aria-current="page">Volunteer</a></li>
          <li><a href="contact_us.html">Contact Us</a></li>
        </ul>
      </div>

      <div class="footer-contact">
        <h3>Contact</h3>
        <p>Email: <a href="mailto:info@hopehaven.org">info@hopehaven.org</a></p>
        <p>Phone: +1 (000) 000-0000</p>
        <p>Address: Athens-Clarke County, Northeast Georgia</p>
      </div>
    </div>

    <hr />
    <div class="footer-follow">
      <h3>Follow Us</h3>
      <ul>
        <li><a href="#" aria-label="Facebook"><i class="fab fa-facebook-f" aria-hidden="true"></i></a></li>
        <li><a href="#" aria-label="Twitter"><i class="fab fa-twitter" aria-hidden="true"></i></a></li>
        <li><a href="#" aria-label="Instagram"><i class="fab fa-instagram" aria-hidden="true"></i></a></li>
        <li><a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in" aria-hidden="true"></i></a></li>
      </ul>
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById("current-year").textContent = new Date().getFullYear();

    // ===== Email compose (mailto / Gmail / Outlook) =====
    (function () {
      const RECIPIENT = 'info@hopehaven.org'; // change if needed
      const form = document.getElementById('enquiryForm');
      const status = document.getElementById('formStatus');

      const enc = (s) => encodeURIComponent(s || '');
      const NL = '\r\n';

      function composeMailto(to, subject, body) {
        return 'mailto:' + enc(to) + '?subject=' + enc(subject) + '&body=' + enc(body);
      }
      function composeGmail(to, subject, body) {
        return 'https://mail.google.com/mail/?view=cm&fs=1&to=' + enc(to) + '&su=' + enc(subject) + '&body=' + enc(body);
      }
      function composeOutlook(to, subject, body) {
        return 'https://outlook.office.com/mail/deeplink/compose?to=' + enc(to) + '&subject=' + enc(subject) + '&body=' + enc(body);
      }
      function isValidEmail(v) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
      }

      form.addEventListener('submit', function (e) {
        e.preventDefault();

        // Honeypot check
        if ((form.company && form.company.value.trim().length) > 0) {
          // likely a bot; silently abort
          return;
        }

        const name = (document.getElementById('enqName').value || '').trim();
        const email = (document.getElementById('enqEmail').value || '').trim();
        const phone = (document.getElementById('enqPhone').value || '').trim();
        const type = (document.getElementById('enqType').value || '').trim() || 'General';
        const message = (document.getElementById('enqMessage').value || '').trim();
        const consent = document.getElementById('enqConsent').checked;
        const contactMethod = (form.querySelector('input[name="contact_method"]:checked') || {}).value || 'email';
        const sendMethod = (form.querySelector('input[name="sendMethod"]:checked') || {}).value || 'mailto';

        // Minimal validation
        if (!name || !isValidEmail(email) || !message || !consent || !type) {
          status.textContent = 'Please complete your name, a valid email, enquiry type, message, and consent.';
          return;
        }
        status.textContent = '';

        const subject = `[${type}] Enquiry from ${name}`.slice(0, 150);
        const body = [
          'Hello Hope Haven team,', '',
          message, '',
          '---',
          `Name: ${name}`,
          `Email: ${email}`,
          phone ? `Phone: ${phone}` : '',
          `Preferred contact: ${contactMethod}`,
          `Enquiry type: ${type}`,
          'Sent from: Volunteer / Enquiry form'
        ].filter(Boolean).join(NL);

        let url = '';
        if (sendMethod === 'gmail') {
          url = composeGmail(RECIPIENT, subject, body);
          window.open(url, '_blank', 'noopener,noreferrer');
        } else if (sendMethod === 'outlook') {
          url = composeOutlook(RECIPIENT, subject, body);
          window.open(url, '_blank', 'noopener,noreferrer');
        } else {
          url = composeMailto(RECIPIENT, subject, body);
          window.location.assign(url);
        }

        status.textContent = 'Draft opened. Review and send in your chosen email service.';
        form.reset();
      });
    })();
  </script>

  <!-- If /js/forms.js also attaches a submit handler to #enquiryForm, remove it to avoid conflicts -->
  <script src="/js/forms.js" defer></script>
</body>
</html>
